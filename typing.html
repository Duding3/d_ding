<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í”„ë¦¬ë¯¸ì—„ íƒ€ì ì—°ìŠµ v7.0</title>
    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.25);
            --text-dim: rgba(255, 255, 255, 0.6);
            --accent-color: #00d2ff;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
            background: radial-gradient(circle at 20% 30%, #1e3a8a 0%, #0f172a 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            background: var(--glass-bg);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border-radius: 30px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            padding: 1.5rem;
            /* ëª¨ë°”ì¼ ëŒ€ì‘ íŒ¨ë”© ì¶•ì†Œ */
            width: 92%;
            max-width: 1050px;
            text-align: center;
            margin: 10px auto;
        }

        /* ìƒë‹¨ ì»¨íŠ¸ë¡¤ ì˜ì—­ ë ˆì´ì•„ì›ƒ ìˆ˜ì • */
        .top-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            gap: 10px;
        }

        .category-menu {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            justify-content: flex-start;
        }

        /* í„°ì¹˜í•˜ê¸° í¸í•˜ë„ë¡ ë²„íŠ¼ í¬ê¸° ë° ê°„ê²© ì¡°ì • */
        .cat-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            color: white;
            padding: 10px 16px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
            font-size: 0.85rem;
            -webkit-tap-highlight-color: transparent;
            /* ëª¨ë°”ì¼ í„°ì¹˜ ì”ìƒ ì œê±° */
        }

        .cat-btn.active {
            background: white;
            color: #0f172a;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        }

        .refresh-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
            font-size: 0.8rem;
            font-weight: bold;
            white-space: nowrap;
        }

        /* ìƒíƒœë°” ëª¨ë°”ì¼ ëŒ€ì‘ */
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-item {
            display: flex;
            flex-direction: column;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-dim);
            margin-bottom: 3px;
        }

        .stat-val {
            font-size: 1.4rem;
            font-weight: 800;
            font-family: 'Courier New', monospace;
        }

        #accuracy {
            color: #00ff88;
        }

        #cpm {
            color: #00d2ff;
        }

        #lastCpm {
            color: #f1c40f;
        }

        /* íƒ€ì í‘œì‹œì°½ */
        .quote-display {
            font-size: 1.3rem;
            line-height: 1.6;
            text-align: left;
            padding: 20px;
            background: rgba(0, 0, 0, 0.25);
            border-radius: 20px;
            min-height: 100px;
            margin-bottom: 15px;
            color: rgba(255, 255, 255, 0.4);
            white-space: pre-wrap;
            word-break: break-all;
            border: 1px solid rgba(255, 255, 255, 0.05);
            user-select: none;
            font-family: 'Courier New', Courier, monospace;
        }

        .quote-display span {
            font-weight: normal !important;
        }

        .correct {
            color: #22c55e !important;
            text-shadow: 0 0 8px rgba(34, 197, 94, 0.6);
        }

        .incorrect {
            color: #ff4d4d !important;
            background: rgba(255, 77, 77, 0.3);
            text-decoration: underline;
        }

        /* ì…ë ¥ì°½ ëª¨ë°”ì¼ ìµœì í™” (ìë™ ì¤Œ ë°©ì§€ë¥¼ ìœ„í•´ font-size 16px ì´ìƒ ê¶Œì¥) */
        .quote-input {
            width: 100%;
            height: 100px;
            background: rgba(255, 255, 255, 0.07);
            border: 2px solid var(--glass-border);
            border-radius: 15px;
            padding: 15px;
            color: white;
            font-size: 1.1rem;
            line-height: 1.4;
            outline: none;
            resize: none;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
            margin-bottom: 15px;
        }

        /* [í•µì‹¬] í‚¤ë³´ë“œ ëª¨ë°”ì¼ ëŒ€ì‘ (í™”ë©´ í¬ê¸°ì— ë”°ë¼ ì¶•ì†Œ) */
        .keyboard-wrapper {
            width: 100%;
            overflow: hidden;
            /* ëª¨ë°”ì¼ì—ì„œ ì‚ì ¸ë‚˜ê°€ì§€ ì•Šê²Œ */
        }

        .keyboard {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transform-origin: top center;
            /* ëª¨ë°”ì¼ì—ì„œ ìŠ¤ì¼€ì¼ ì¡°ì ˆìš© */
        }

        .row {
            display: flex;
            justify-content: center;
            gap: 5px;
        }

        .key {
            width: 45px;
            height: 45px;
            /* ê¸°ë³¸ í¬ê¸° ì•½ê°„ ì¶•ì†Œ */
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            position: relative;
            transition: background 0.05s ease, box-shadow 0.05s ease;
            flex-shrink: 0;
            /* ë ˆì´ì•„ì›ƒ ê³ ì • */
        }

        .key span {
            position: absolute;
            font-weight: bold;
            color: rgba(255, 255, 255, 0.4);
            pointer-events: none;
        }

        .key .eng {
            top: 4px;
            left: 6px;
            font-size: 0.65rem;
        }

        .key .kor {
            bottom: 4px;
            right: 6px;
            font-size: 0.9rem;
        }

        .key.active {
            background: #fff !important;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
            /* transform ì œê±°í•˜ì—¬ ë ˆì´ì•„ì›ƒ ì›€ì°”ê±°ë¦¼ ë°©ì§€ */
        }

        .key.active span {
            color: #000 !important;
        }

        /* íŠ¹ìˆ˜í‚¤ ëª¨ë°”ì¼ ë¹„ìœ¨ ì¡°ì • */
        .key.backspace {
            width: 80px;
        }

        .key.tab {
            width: 65px;
        }

        .key.caps {
            width: 75px;
        }

        .key.enter {
            width: 90px;
        }

        .key.shift {
            width: 100px;
        }

        .key.space {
            width: 200px;
        }

        /* ëª¨ë°”ì¼ìš© ë¯¸ë””ì–´ ì¿¼ë¦¬ */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
                border-radius: 20px;
            }

            .top-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .refresh-btn {
                justify-content: center;
            }

            .quote-display {
                font-size: 1.1rem;
                padding: 15px;
                min-height: 80px;
            }

            .stat-val {
                font-size: 1.3rem;
            }

            /* ëª¨ë°”ì¼ì—ì„œ í‚¤ë³´ë“œ í¬ê¸°ë¥¼ í™”ë©´ ë„ˆë¹„ì— ë§ì¶¤ */
            .keyboard {
                transform: scale(0.85);
                margin-bottom: -20px;
            }
        }

        @media (max-width: 480px) {
            .keyboard {
                transform: scale(0.65);
                margin-bottom: -40px;
            }

            .key {
                width: 38px;
                height: 38px;
            }

            .cat-btn {
                padding: 8px 12px;
                font-size: 0.75rem;
            }
        }

        .footer {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-dim);
        }

        .info-msg {
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 12px;
            border-radius: 8px;
            color: #fff;
            font-size: 0.7rem;
            font-weight: bold;
        }
    </style>
</head>

<body oncontextmenu="return false">

    <div class="container" id="mainContainer">
        <h1 style="font-family: 'Segoe UI', sans-serif; color: white; margin-bottom: 20px; font-size: 1.8rem;">í”„ë¦¬ë¯¸ì—„ íƒ€ì
            ì—°ìŠµ <span style="font-size: 0.9rem; color: #aaa; opacity: 0.5; font-weight: normal;">v10.0</span></h1>
        <div class="top-controls">
            <div class="category-menu">
                <button class="cat-btn active" id="btn-proverbs" onclick="setCategory('proverbs')">ì§§ì€ ê¸€</button>
                <button class="cat-btn" id="btn-lyrics" onclick="setCategory('lyrics')">ê¸´ ê¸€</button>
                <button class="cat-btn" id="btn-fairy" onclick="setCategory('fairyTales')">ë™í™”</button>
                <button class="cat-btn" id="btn-english" onclick="setCategory('english')">ì˜íƒ€ì—°ìŠµ</button>
            </div>
            <button class="refresh-btn" onclick="render()" title="ë¬¸ì¥ ìƒˆë¡œê³ ì¹¨">âŸ³ ì—…ëƒìš© ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼</button>
        </div>

        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-label">ì •í™•ë„</div>
                <div id="accuracy" class="stat-val">100%</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">í˜„ì¬ íƒ€ìˆ˜</div>
                <div id="cpm" class="stat-val">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">ìµœê·¼ íƒ€ìˆ˜</div>
                <div id="lastCpm" class="stat-val">-</div>
            </div>
        </div>

        <div class="quote-display" id="quoteDisplay" oncopy="return false"></div>
        <textarea class="quote-input" id="quoteInput" placeholder="í„°ì¹˜í•˜ì—¬ ì…ë ¥ì„ ì‹œì‘í•˜ì„¸ìš”..." autocomplete="off"
            spellcheck="false"></textarea>

        <div class="keyboard-wrapper">
            <div class="keyboard" id="visualKeyboard">
                <div class="row">
                    <div class="key" id="Digit1"><span class="eng">1</span></div>
                    <div class="key" id="Digit2"><span class="eng">2</span></div>
                    <div class="key" id="Digit3"><span class="eng">3</span></div>
                    <div class="key" id="Digit4"><span class="eng">4</span></div>
                    <div class="key" id="Digit5"><span class="eng">5</span></div>
                    <div class="key" id="Digit6"><span class="eng">6</span></div>
                    <div class="key" id="Digit7"><span class="eng">7</span></div>
                    <div class="key" id="Digit8"><span class="eng">8</span></div>
                    <div class="key" id="Digit9"><span class="eng">9</span></div>
                    <div class="key" id="Digit0"><span class="eng">0</span></div>
                    <div class="key backspace" id="Backspace"><span class="eng" style="top:12px; left:15px">Back</span>
                    </div>
                </div>
                <div class="row">
                    <div class="key tab" id="Tab"><span class="eng" style="top:12px; left:15px">Tab</span></div>
                    <div class="key" id="KeyQ"><span class="eng">Q</span><span class="kor">ã…‚</span></div>
                    <div class="key" id="KeyW"><span class="eng">W</span><span class="kor">ã…ˆ</span></div>
                    <div class="key" id="KeyE"><span class="eng">E</span><span class="kor">ã„·</span></div>
                    <div class="key" id="KeyR"><span class="eng">R</span><span class="kor">ã„±</span></div>
                    <div class="key" id="KeyT"><span class="eng">T</span><span class="kor">ã……</span></div>
                    <div class="key" id="KeyY"><span class="eng">Y</span><span class="kor">ã…›</span></div>
                    <div class="key" id="KeyU"><span class="eng">U</span><span class="kor">ã…•</span></div>
                    <div class="key" id="KeyI"><span class="eng">I</span><span class="kor">ã…‘</span></div>
                    <div class="key" id="KeyO"><span class="eng">O</span><span class="kor">ã…</span></div>
                    <div class="key" id="KeyP"><span class="eng">P</span><span class="kor">ã…”</span></div>
                </div>
                <div class="row">
                    <div class="key caps" id="CapsLock"><span class="eng" style="top:12px; left:10px">Caps</span></div>
                    <div class="key" id="KeyA"><span class="eng">A</span><span class="kor">ã…</span></div>
                    <div class="key" id="KeyS"><span class="eng">S</span><span class="kor">ã„´</span></div>
                    <div class="key" id="KeyD"><span class="eng">D</span><span class="kor">ã…‡</span></div>
                    <div class="key" id="KeyF"><span class="eng">F</span><span class="kor">ã„¹</span></div>
                    <div class="key" id="KeyG"><span class="eng">G</span><span class="kor">ã…</span></div>
                    <div class="key" id="KeyH"><span class="eng">H</span><span class="kor">ã…—</span></div>
                    <div class="key" id="KeyJ"><span class="eng">J</span><span class="kor">ã…“</span></div>
                    <div class="key" id="KeyK"><span class="eng">K</span><span class="kor">ã…</span></div>
                    <div class="key" id="KeyL"><span class="eng">L</span><span class="kor">ã…£</span></div>
                    <div class="key enter" id="Enter"><span class="eng" style="top:12px; left:20px">Enter</span></div>
                </div>
                <div class="row">
                    <div class="key shift" id="ShiftLeft"><span class="eng" style="top:12px; left:15px">Shift</span>
                    </div>
                    <div class="key" id="KeyZ"><span class="eng">Z</span><span class="kor">ã…‹</span></div>
                    <div class="key" id="KeyX"><span class="eng">X</span><span class="kor">ã…Œ</span></div>
                    <div class="key" id="KeyC"><span class="eng">C</span><span class="kor">ã…Š</span></div>
                    <div class="key" id="KeyV"><span class="eng">V</span><span class="kor">ã…</span></div>
                    <div class="key" id="KeyB"><span class="eng">B</span><span class="kor">ã… </span></div>
                    <div class="key" id="KeyN"><span class="eng">N</span><span class="kor">ã…œ</span></div>
                    <div class="key" id="KeyM"><span class="eng">M</span><span class="kor">ã…¡</span></div>
                    <div class="key shift" id="ShiftRight"><span class="eng" style="top:12px; left:15px">Shift</span>
                    </div>
                </div>
                <div class="row">
                    <div class="key space" id="Space"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <div>íˆ¬ëª…ë„: <input type="range" id="opacitySlider" min="0.3" max="1" step="0.1" value="1"></div>
            <div class="info-msg">ğŸ’¡ Shift + Enter ì¤„ë°”ê¿ˆ</div>
        </div>
    </div>

    <script>
        // DOM ìš”ì†Œ ì°¸ì¡°
        const quoteDisplay = document.getElementById('quoteDisplay');
        const quoteInput = document.getElementById('quoteInput');
        const accEl = document.getElementById('accuracy');
        const cpmEl = document.getElementById('cpm');
        const lastCpmEl = document.getElementById('lastCpm');

        // [ë°ì´í„° ì˜ì—­] v6.3 ìœ ì§€
        const typingData = {
            proverbs: ["ê°€ëŠ” ë§ì´ ê³ ì™€ì•¼ ì˜¤ëŠ” ë§ì´ ê³±ë‹¤.", "ë“±ì” ë°‘ì´ ì–´ë‘¡ë‹¤.", "ì„¸ ì‚´ ë²„ë¦‡ ì—¬ë“ ê¹Œì§€ ê°„ë‹¤.", "ê³ ìƒ ëì— ë‚™ì´ ì˜¨ë‹¤.", "ì›ìˆ­ì´ë„ ë‚˜ë¬´ì—ì„œ ë–¨ì–´ì§„ë‹¤.", "ì‹œì‘ì´ ë°˜ì´ë‹¤.", "ìƒ¤ë© ì£½ì–´!", "ìƒ¤ë© ë§í•´ë¼!"],
            lyrics: ["ë™í•´ ë¬¼ê³¼ ë°±ë‘ì‚°ì´ ë§ˆë¥´ê³  ë‹³ë„ë¡ í•˜ëŠë‹˜ì´ ë³´ìš°í•˜ì‚¬ ìš°ë¦¬ë‚˜ë¼ ë§Œì„¸.", "ë©ˆì¶”ì§€ ë§ê³  ê¿ˆì„ í–¥í•´ ë‹¬ë ¤ê°€ì„¸ìš”. ë‹¹ì‹ ì˜ ë…¸ë ¥ì€ ë°°ì‹ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.", "í”ë“¤ë¦¬ì§€ ì•Šê³  í”¼ëŠ” ê½ƒì´ ì–´ë”” ìˆìœ¼ë´."],
            fairyTales: ["ì˜›ë‚  ì˜›ì  ì•„ì£¼ ë¨¼ ì˜›ë‚ , ìˆ²ì† ì‘ì€ ì§‘ì— ì¼ê³± ë‚œìŸì´ì™€ ë°±ì„¤ê³µì£¼ê°€ ì‚´ê³  ìˆì—ˆì–´ìš”."],
            english: ["Practice makes perfect.", "No pain, no gain.", "Better late than never.", "Action speaks louder than words."]
        };

        let currentCategory = 'proverbs';
        let timer, timeElapsed = 0, timerStarted = false;
        let lastCpm = "-";
        let lastSentence = "";

        function forceClearKeys() {
            document.querySelectorAll('.key.active').forEach(k => k.classList.remove('active'));
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function setCategory(cat) {
            currentCategory = cat;
            lastCpm = "-";
            lastCpmEl.innerText = "-";
            document.querySelectorAll('.cat-btn').forEach(btn => btn.classList.remove('active'));
            const targetBtn = document.getElementById(`btn-${cat === 'fairyTales' ? 'fairy' : (cat === 'english' ? 'english' : cat)}`);
            if (targetBtn) targetBtn.classList.add('active');
            render();
        }

        function render() {
            const list = [...typingData[currentCategory]];
            let finalStr = "";

            if (currentCategory === 'lyrics') {
                const shuffled = shuffleArray(list);
                finalStr = shuffled.slice(0, 2).join('\n\n');
            } else {
                let selected;
                do {
                    selected = list[Math.floor(Math.random() * list.length)];
                } while (selected === lastSentence && list.length > 1);
                finalStr = selected;
                lastSentence = selected;
            }

            quoteDisplay.innerHTML = '';
            finalStr.split('').forEach(char => {
                const span = document.createElement('span');
                span.innerText = char;
                quoteDisplay.appendChild(span);
            });

            quoteInput.value = '';
            clearInterval(timer);
            timerStarted = false;
            timeElapsed = 0;
            cpmEl.innerText = "0";
            accEl.innerText = "100%";
            forceClearKeys();
            // ëª¨ë°”ì¼ì—ì„œëŠ” í¬ì»¤ìŠ¤ë¥¼ ì£¼ë©´ í‚¤ë³´ë“œê°€ ì˜¬ë¼ì™€ í™”ë©´ì„ ê°€ë¦´ ìˆ˜ ìˆìœ¼ë¯€ë¡œ í•„ìš”ì‹œ ì£¼ì„ í•´ì œ
            // quoteInput.focus();
        }

        window.addEventListener('keydown', (e) => {
            const key = document.getElementById(e.code);
            if (key) key.classList.add('active');
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                if (quoteInput.value.length > 0) {
                    lastCpm = cpmEl.innerText;
                    lastCpmEl.innerText = lastCpm;
                    setTimeout(render, 50);
                }
            }
        });

        window.addEventListener('keyup', (e) => {
            const key = document.getElementById(e.code);
            if (key) key.classList.remove('active');
        });

        window.addEventListener('blur', forceClearKeys);
        window.addEventListener('mousedown', forceClearKeys);

        quoteInput.addEventListener('input', () => {
            if (!timerStarted && quoteInput.value.length > 0) {
                timerStarted = true;
                timer = setInterval(() => { timeElapsed += 0.1; }, 100);
            }
            const spans = quoteDisplay.querySelectorAll('span');
            const inputChars = quoteInput.value.split('');
            let mistakes = 0;
            spans.forEach((span, i) => {
                const char = inputChars[i];
                if (char == null) span.className = '';
                else if (char === span.innerText) span.className = 'correct';
                else { span.className = 'incorrect'; mistakes++; }
            });
            accEl.innerText = inputChars.length > 0 ? Math.floor(((inputChars.length - mistakes) / inputChars.length) * 100) + "%" : "100%";
            if (timeElapsed > 0 && inputChars.length > 0) cpmEl.innerText = Math.floor((inputChars.length / timeElapsed) * 60);
        });

        document.getElementById('opacitySlider').addEventListener('input', (e) => {
            document.getElementById('mainContainer').style.opacity = e.target.value;
        });

        render();
    </script>
</body>

</html>