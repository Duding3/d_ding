<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="app-version" content="1.0.92">
    <title>JiHye Mini-Games</title>
    <link rel="stylesheet" href="style.css?v=1.0.92">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>

    <header>
        <h1>🎮 JiHye Mini-Games <span id="home-version-badge"></span></h1>
        <div class="home-note">
            <p class="home-note-line">냥냥?! 아직 테스트중인 게임들 수정 ing</p>
            <p class="home-note-line rank-login-notice">랭킹전은 구글로 로그인 해야 가능</p>
        </div>

        <div class="home-header-actions">
            <button id="update-refresh-btn" class="update-refresh-btn">
                <i class="fas fa-sync-alt"></i> 새로고침
            </button>
            <a href="hall-of-fame.html" class="ranking-btn">
                <i class="fas fa-crown"></i> 명예의 전당
            </a>
            <button id="home-auth-btn" class="ranking-btn auth-btn" disabled>
                <i class="fas fa-spinner"></i> 로그인 확인 중...
            </button>
        </div>
        <p id="home-auth-status" class="home-auth-status">로그인 상태 확인 중...</p>
        <button id="home-nickname-btn" class="home-nickname-btn" type="button" style="display:none;">닉네임 변경</button>
    </header>

    <main class="game-container">
        <div class="game-section-title section-bugcheck">
            <h3><i class="fas fa-bug"></i> 버그체크 게임 리스트</h3>
        </div>

        <div class="game-card">
            <div class="icon-wrapper">
                <i class="fas fa-arrow-up"></i>
            </div>
            <h2>슬라임 점프 (Jump)</h2>
            <p>점프해서 올라가 보던지!</p>
            <a href="Jump.html" class="play-btn">게임 시작</a>
        </div>

        <div class="game-card">
            <div class="icon-wrapper">
                <i class="fas fa-shapes"></i>
            </div>
            <h2>테트리스 (Tetris)</h2>
            <p>블록 맞춰서 잘 지워보던지!</p>
            <a href="Tetris.html" class="play-btn">게임 시작</a>
        </div>

        <div class="game-card">
            <div class="icon-wrapper">
                <i class="fas fa-th"></i>
            </div>
            <h2>블록블라스트 (Block Blast)</h2>
            <p>블록을 배치해서 가로/세로 줄을 폭파시켜 보던지!</p>
            <a href="BlockBlast.html" class="play-btn">게임 시작</a>
        </div>

        <div class="game-card">
            <div class="icon-wrapper">
                <i class="fas fa-wave-square"></i>
            </div>
            <h2>네온 스네이크 (Snake)</h2>
            <p>벽 피해서 먹이 먹고 길어져 보던지!</p>
            <a href="Snake.html" class="play-btn">게임 시작</a>
        </div>

        <div class="game-card">
            <div class="icon-wrapper" style="position: relative;">
                <div
                    style="position: absolute; transform: translate(-15px, -10px) rotate(-5deg); background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.2); width: 60px; height: 80px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-cat" style="font-size: 1.8rem; opacity: 0.8; color: #4ade80;"></i>
                </div>
                <div
                    style="position: absolute; transform: translate(15px, 10px) rotate(5deg); background: rgba(255, 255, 255, 0.1); border: 2px solid #4ade80; width: 60px; height: 80px; border-radius: 8px; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);">
                    <i class="fas fa-cat" style="font-size: 1.8rem; color: #4ade80;"></i>
                </div>
            </div>
            <h2>메모리 매치 (Memory)</h2>
            <p>뒤집어서 짝 맞춰 보던지!</p>
            <a href="Memory.html" class="play-btn">게임 시작</a>
        </div>

        <div class="game-card">
            <div class="icon-wrapper">
                <i class="fas fa-hands"></i>
            </div>
            <h2>클라운 캐치 (Catch)</h2>
            <p>폭탄을 피하고 선물을 다 받아보던지!</p>
            <a href="Catch.html" class="play-btn">게임 시작</a>
        </div>

        <div class="game-card">
            <div class="icon-wrapper">
                <i class="fas fa-keyboard"></i>
            </div>
            <h2>타자 연습 (Typing)</h2>
            <p>대충 타자 실력 뽐내보던지!</p>
            <a href="typing.html" class="play-btn">연습 시작</a>
        </div>

        <div class="game-section-title section-progress">
            <h3><i class="fas fa-flask"></i> 개발 진행중인 게임 리스트</h3>
        </div>

        <div class="game-card">
            <div class="icon-wrapper">
                <i class="fas fa-dragon"></i>
            </div>
            <h2>달려달려 (Chrome Dino)</h2>
            <p>인터넷 끊기면 하던 그 게임 해보던지!</p>
            <a href="Dino.html" class="play-btn">게임 시작</a>
        </div>

        <div class="game-card">
            <div class="icon-wrapper">
                <i class="fas fa-meteor"></i>
            </div>
            <h2>코스믹 닷지 (Dodge)</h2>
            <p>우주에서 쏟아지는 행성을 피해보던지!</p>
            <a href="Dodge.html" class="play-btn">게임 시작</a>
        </div>

        <div class="game-card">
            <div class="icon-wrapper">
                <i class="fas fa-layer-group"></i>
            </div>
            <h2>퍼펙트 타워 (Stack)</h2>
            <p>블록을 높게높게 쌓아보던지!</p>
            <a href="Stack.html" class="play-btn">게임 시작</a>
        </div>

        <div class="game-card coming-soon">
            <div class="icon-wrapper">
                <i class="fas fa-plus"></i>
            </div>
            <h2>Coming Soon</h2>
            <p>또 다른 재미를 준비 중입니다.</p>
        </div>
    </main>

    <footer>
        <p>&copy; 2026 Jihye Mini-Games. All rights reserved.</p>
    </footer>

    <script src="leaderboard-system.js"></script>
    <script>
        const homeVersion = document.querySelector('meta[name="app-version"]')?.content || '1';
        document.title = `JiHye Mini-Games v${homeVersion}`;
        const versionBadge = document.getElementById('home-version-badge');
        if (versionBadge) versionBadge.textContent = `v${homeVersion}`;

        document.getElementById('update-refresh-btn').addEventListener('click', function () {
            const currentUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
            window.location.href = currentUrl + '?update=' + new Date().getTime();
        });

        const homeAuthBtn = document.getElementById('home-auth-btn');
        const homeAuthStatus = document.getElementById('home-auth-status');
        const homeNicknameBtn = document.getElementById('home-nickname-btn');

        async function renderHomeAuth(user) {
            if (!homeAuthBtn || !homeAuthStatus || !homeNicknameBtn) return;
            homeAuthBtn.disabled = false;
            if (user) {
                let name = user.displayName || 'Google 사용자';
                if (window.LeaderboardSystem.getPreferredDisplayName) {
                    try {
                        name = await window.LeaderboardSystem.getPreferredDisplayName(user);
                    } catch (e) {
                        // no-op
                    }
                }
                homeAuthBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i> 로그아웃';
                homeAuthStatus.textContent = `로그인됨: ${name}`;
                homeNicknameBtn.style.display = 'inline-flex';
                homeNicknameBtn.disabled = false;
            } else {
                homeAuthBtn.innerHTML = '<i class="fab fa-google"></i> Google 로그인';
                homeAuthStatus.textContent = '로그인되지 않음';
                homeNicknameBtn.style.display = 'none';
                homeNicknameBtn.disabled = true;
            }
        }

        if (window.LeaderboardSystem) {
            window.LeaderboardSystem.onAuthChange(renderHomeAuth);
        } else if (homeAuthStatus) {
            homeAuthStatus.textContent = '로그인 모듈 로드 실패';
        }

        homeAuthBtn?.addEventListener('click', async function () {
            if (!window.LeaderboardSystem) return;
            homeAuthBtn.disabled = true;
            try {
                if (window.LeaderboardSystem.getCurrentUser()) {
                    await window.LeaderboardSystem.signOutUser();
                } else {
                    await window.LeaderboardSystem.signInWithGoogle();
                }
            } catch (e) {
                if (homeAuthStatus) {
                    homeAuthStatus.textContent = '로그인 처리 중 오류가 발생했습니다.';
                }
            } finally {
                homeAuthBtn.disabled = false;
            }
        });

        homeNicknameBtn?.addEventListener('click', async function () {
            if (!window.LeaderboardSystem) return;
            const user = window.LeaderboardSystem.getCurrentUser?.();
            if (!user) return;
            const currentLabel = (homeAuthStatus.textContent || '').replace(/^로그인됨:\s*/, '').trim();
            const nextName = window.prompt('사용하실 닉네임을 입력하세요 (최대 12자)', currentLabel || '');
            if (nextName === null) return;
            homeNicknameBtn.disabled = true;
            try {
                if (window.LeaderboardSystem.setServerNickname) {
                    const saved = await window.LeaderboardSystem.setServerNickname(nextName);
                    homeAuthStatus.textContent = `로그인됨: ${saved}`;
                }
            } catch (e) {
                const code = (e && e.code) ? ` (${e.code})` : '';
                homeAuthStatus.textContent = `닉네임 변경 실패${code}`;
            } finally {
                if (window.LeaderboardSystem.getCurrentUser?.()) {
                    homeNicknameBtn.disabled = false;
                }
            }
        });
    </script>

</body>

</html>
